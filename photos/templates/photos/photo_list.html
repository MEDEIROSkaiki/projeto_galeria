{% extends "photos/photo_base.html" %}

{% block title %}Galeria de Viagens - Explore o Mundo!{% endblock %}

{% block extra_style %}
    .header-bg {
        background: linear-gradient(135deg, #0f4c75 0%, #3282b8 100%);
    }
    .masonry-container {
        column-count: 1;
        column-gap: 1.5rem;
    }
    @media (min-width: 768px) { .masonry-container { column-count: 2; } }
    @media (min-width: 1024px) { .masonry-container { column-count: 3; } }
    .masonry-item {
        display: inline-block;
        width: 100%;
        margin-bottom: 1.5rem;
        break-inside: avoid;
    }
    .card-image-wrapper { position: relative; overflow: hidden; }
    .card-image { transition: transform 0.4s ease-in-out; }
    .overlay {
        position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background-color: rgba(0, 0, 0, 0.4);
        display: flex; justify-content: center; align-items: center;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
    }
    .masonry-item:hover .card-image { transform: scale(1.08); }
    .masonry-item:hover .overlay { opacity: 1; }
{% endblock %}

{% block content %}
<div class="header-bg py-16 shadow-lg">
    <div class="container mx-auto px-4 text-center">
        <h1 class="text-6xl font-bold text-white mb-4 drop-shadow-md">Galeria de Viagens</h1>
        <p class="text-xl text-blue-200 mb-8">Suas memórias mais preciosas, em um só lugar.</p>

        <form method="GET" action="{% url 'photo_list' %}" class="max-w-xl mx-auto relative">
            <input type="text" name="search_query" value="{{ search_query }}" placeholder="Buscar por título, local ou descrição..." class="w-full pl-12 pr-4 py-3 text-lg border-2 border-blue-300 rounded-full focus:outline-none focus:ring-4 focus:ring-blue-200 transition-shadow bg-white text-gray-800 shadow-inner">
            <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
            <button type="submit" class="absolute right-2 top-1/2 -translate-y-1/2 bg-blue-600 text-white px-6 py-2 rounded-full hover:bg-blue-700 transition-colors shadow-md">Buscar</button>
        </form>
    </div>
</div>

<div class="container mx-auto px-4 py-12">
    {% if not photos %}
        <div class="text-center py-10">
            <p class="text-gray-500 text-2xl mb-4">Nenhuma foto encontrada para a sua busca.</p>
            <a href="{% url 'photo_list' %}" class="text-blue-600 hover:text-blue-800 font-semibold text-lg">Ver todas as fotos</a>
        </div>
    {% else %}
        <div class="masonry-container">
            {% for photo in photos %}
            <a href="{% url 'photo_detail' photo.pk %}" class="masonry-item group">
                <div class="bg-white rounded-xl shadow-xl overflow-hidden transition-all duration-300 hover:shadow-2xl hover:-translate-y-1 transform">
                    <div class="card-image-wrapper">
                        {% if photo.image %}
                        <img src="{{ photo.image.url }}" alt="{{ photo.title }}" class="w-full object-cover card-image h-64">
                        {% endif %}
                        <div class="overlay">
                            <i class="fas fa-eye text-white text-4xl"></i>
                        </div>
                    </div>
                    <div class="p-5">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2 truncate">{{ photo.title }}</h2>
                        <div class="flex items-center text-gray-600 mb-3 text-lg">
                            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>
                            <span class="truncate">{{ photo.location }}</span>
                        </div>
                        <p class="text-sm text-gray-500 flex items-center">
                            <i class="fas fa-clock text-orange-400 mr-2"></i>
                            Publicado há {{ photo.published_at|timesince }}
                        </p>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endblock %}